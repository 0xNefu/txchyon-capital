---
import Base from '../layouts/Base.astro';

const isAuthenticated = typeof window !== 'undefined' ? localStorage.getItem('capital_dashboard_auth') === 'true' : false;

if (isAuthenticated && typeof window !== 'undefined') {
  window.location.href = '/dashboard';
}
---

<Base>
  <section class="min-h-screen bg-black">
    <div class="container mx-auto px-4 py-20">
      <!-- Back Link -->
      <a href="/" class="inline-flex items-center gap-2 text-gray-500 hover:text-gray-300 mb-12 transition-colors text-sm">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        Return to system
      </a>
      
      <!-- Login Container -->
      <div class="max-w-sm mx-auto">
        <!-- Logo -->
        <div class="flex justify-center mb-8">
          <img 
            src="/images/logo.png" 
            alt="Txchyon Capital Logo" 
            class="h-12 w-auto object-contain opacity-90"
            onerror="this.style.display='none'; document.getElementById('login-fallback-logo').style.display='block';"
          />
          <div id="login-fallback-logo" class="hidden text-3xl">⚫</div>
        </div>
        
        <!-- Header -->
        <div class="text-center mb-10">
          <h1 class="text-2xl font-light text-white mb-2">System Access</h1>
          <p class="text-gray-500 text-sm">Internal operating system</p>
        </div>
        
        <!-- Login Form -->
        <div class="border border-gray-800 rounded-lg p-8">
          <form id="login-form" class="space-y-6">
            <div>
              <label class="block text-xs text-gray-500 mb-2 uppercase tracking-wider">Access Code</label>
              <input 
                type="password" 
                id="password" 
                placeholder="Enter system passphrase" 
                class="w-full px-4 py-3 bg-black border border-gray-800 rounded text-white placeholder-gray-600 focus:outline-none focus:border-gray-700 transition-colors text-sm"
                autocomplete="current-password"
                required
                autofocus
              />
            </div>
            
            <button 
              type="submit" 
              class="w-full py-3 border border-gray-700 text-gray-300 hover:text-white hover:border-gray-600 rounded transition-colors text-sm"
            >
              Authenticate
            </button>
          </form>
          
          <!-- Security Notes -->
          <div class="mt-10 pt-8 border-t border-gray-800">
            <div class="space-y-3 text-xs text-gray-500">
              <div class="flex items-start gap-2">
                <span>•</span>
                <span>End-to-end encrypted connection</span>
              </div>
              <div class="flex items-start gap-2">
                <span>•</span>
                <span>Internal system only</span>
              </div>
              <div class="flex items-start gap-2">
                <span>•</span>
                <span>Access attempts are monitored</span>
              </div>
            </div>
            
            <div class="mt-8 text-center">
              <p class="text-gray-600 text-xs">
                For authorized system operators only.
              </p>
            </div>
          </div>
        </div>
        
        <!-- System Status -->
        <div class="mt-8 text-center">
          <div class="inline-flex items-center gap-2 text-xs text-gray-500">
            <div class="w-1.5 h-1.5 bg-green-500 rounded-full"></div>
            <span>System: Operational</span>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <script>
    document.getElementById('login-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const password = document.getElementById('password').value;
      const button = this.querySelector('button');
      
      // Show authenticating state
      const originalText = button.textContent;
      button.textContent = 'Authenticating...';
      button.disabled = true;
      
      // Simple delay for security feel
      setTimeout(() => {
        // UPDATE THIS PASSWORD TO YOUR ACTUAL PASSWORD
        if (password === 'YOUR_ACTUAL_PASSWORD_HERE') {
          localStorage.setItem('capital_dashboard_auth', 'true');
          localStorage.setItem('capital_last_login', new Date().toISOString());
          
          // Success state
          button.textContent = 'Access Granted';
          button.classList.remove('border-gray-700', 'hover:border-gray-600');
          button.classList.add('border-green-800', 'text-green-400');
          
          // Redirect to dashboard
          setTimeout(() => {
            window.location.href = '/dashboard';
          }, 600);
        } else {
          // Reset button
          button.textContent = originalText;
          button.disabled = false;
          
          // Show error on input
          const input = document.getElementById('password');
          input.value = '';
          input.focus();
          input.classList.add('border-red-800');
          
          // Reset input border after delay
          setTimeout(() => {
            input.classList.remove('border-red-800');
          }, 1000);
        }
      }, 600);
    });
    
    // Auto-focus password field
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('password').focus();
    });
  </script>
</Base>

<style>
  /* Minimalist focus styles */
  input:focus {
    outline: none;
    box-shadow: none;
  }
  
  /* Smooth transitions */
  * {
    transition: border-color 0.2s ease, color 0.2s ease;
  }
</style>